#!/usr/bin/env python3

import matplotlib.pyplot as plt

message_sizes = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140,
                 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260,
                 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380,
                 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500,
                 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620,
                 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740,
                 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860,
                 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980,
                 990, 1000, 1010, 1020, 1030, 1040, 1050, 1060, 1070, 1080,
                 1090, 1100, 1110, 1120, 1130, 1140, 1150, 1160, 1170, 1180,
                 1190, 1200, 1210, 1220, 1230, 1240, 1250, 1260, 1270, 1280,
                 1290, 1300, 1310, 1320, 1330, 1340, 1350, 1360, 1370, 1380,
                 1390, 1400, 1410, 1420, 1430, 1440, 1450, 1460, 1470, 1480,
                 1490, 1500, 1510, 1520, 1530, 1540, 1550, 1560, 1570, 1580,
                 1590, 1600, 1610, 1620, 1630, 1640, 1650, 1660, 1670, 1680,
                 1690, 1700, 1710, 1720, 1730, 1740, 1750, 1760, 1770, 1780,
                 1790, 1800, 1810, 1820, 1830, 1840, 1850, 1860, 1870, 1880,
                 1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980,
                 1990, 2000, 2010, 2020, 2030, 2040, 2050, 2060, 2070, 2080,
                 2090, 2100, 2110, 2120, 2130, 2140, 2150, 2160, 2170, 2180,
                 2190, 2200, 2210, 2220, 2230, 2240, 2250, 2260, 2270, 2280,
                 2290, 2300, 2310, 2320, 2330, 2340, 2350, 2360, 2370, 2380,
                 2390, 2400, 2410, 2420, 2430, 2440, 2450, 2460, 2470, 2480,
                 2490, 2500, 2510, 2520, 2530, 2540, 2550, 2560, 2570, 2580,
                 2590, 2600, 2610, 2620, 2630, 2640, 2650, 2660, 2670, 2680,
                 2690, 2700, 2710, 2720, 2730, 2740, 2750, 2760, 2770, 2780,
                 2790, 2800, 2810, 2820, 2830, 2840, 2850, 2860, 2870, 2880,
                 2890, 2900, 2910, 2920, 2930, 2940, 2950, 2960, 2970, 2980,
                 2990, 3000, 3010, 3020, 3030, 3040, 3050, 3060, 3070, 3080,
                 3090, 3100, 3110, 3120, 3130, 3140, 3150, 3160, 3170, 3180,
                 3190, 3200, 3210, 3220, 3230, 3240, 3250, 3260, 3270, 3280,
                 3290, 3300, 3310, 3320, 3330, 3340, 3350, 3360, 3370, 3380,
                 3390, 3400, 3410, 3420, 3430, 3440, 3450, 3460, 3470, 3480,
                 3490, 3500, 3510, 3520, 3530, 3540, 3550, 3560, 3570, 3580,
                 3590, 3600, 3610, 3620, 3630, 3640, 3650, 3660, 3670, 3680,
                 3690, 3700, 3710, 3720, 3730, 3740, 3750, 3760, 3770, 3780,
                 3790, 3800, 3810, 3820, 3830, 3840, 3850, 3860, 3870, 3880,
                 3890, 3900, 3910, 3920, 3930, 3940, 3950, 3960, 3970, 3980,
                 3990, 4000, 4000, 4100, 4200, 4300, 4400, 4500, 4600, 4700,
                 4800, 4900, 5000, 5100, 5200, 5300, 5400, 5500, 5600, 5700,
                 5800, 5900, 6000, 6100, 6200, 6300, 6400, 6500, 6600, 6700,
                 6800, 6900, 7000, 7100, 7200, 7300, 7400, 7500, 7600, 7700,
                 7800, 7900, 8000, 8100, 8200, 8300, 8400, 8500, 8600, 8700,
                 8800, 8900, 9000, 9100, 9200, 9300, 9400, 9500, 9600, 9700,
                 9800, 9900, 10000, 10100, 10200, 10300, 10400, 10500, 10600,
                 10700, 10800, 10900, 11000, 11100, 11200, 11300, 11400, 11500,
                 11600, 11700, 11800, 11900, 12000, 12100, 12200, 12300, 12400,
                 12500, 12600, 12700, 12800, 12900, 13000, 13100, 13200, 13300,
                 13400, 13500, 13600, 13700, 13800, 13900, 14000, 14100, 14200,
                 14300, 14400, 14500, 14600, 14700, 14800, 14900, 15000, 15100,
                 15200, 15300, 15400, 15500, 15600, 15700, 15800, 15900, 16000,
                 16100, 16200, 16300, 16400, 16500, 16600, 16700, 16800, 16900,
                 17000, 17100, 17200, 17300, 17400, 17500, 17600, 17700, 17800,
                 17900, 18000, 18100, 18200, 18300, 18400, 18500, 18600, 18700,
                 18800, 18900, 19000, 19100, 19200, 19300, 19400, 19500, 19600,
                 19700, 19800, 19900, 20000, 20100, 20200, 20300, 20400, 20500,
                 20600, 20700, 20800, 20900, 21000, 21100, 21200, 21300, 21400,
                 21500, 21600, 21700, 21800, 21900, 22000, 22100, 22200, 22300,
                 22400, 22500, 22600, 22700, 22800, 22900, 23000, 23100, 23200,
                 23300, 23400, 23500, 23600, 23700, 23800, 23900, 24000, 24100,
                 24200, 24300, 24400, 24500, 24600, 24700, 24800, 24900, 25000,
                 25100, 25200, 25300, 25400, 25500, 25600, 25700, 25800, 25900,
                 26000, 26100, 26200, 26300, 26400, 26500, 26600, 26700, 26800,
                 26900, 27000, 27100, 27200, 27300, 27400, 27500, 27600, 27700,
                 27800, 27900, 28000, 28100, 28200, 28300, 28400, 28500, 28600,
                 28700, 28800, 28900, 29000, 29100, 29200, 29400, 29500, 29600,
                 29700, 29800, 29900]

one_way_delay_min = [2.73, 2.79, 2.82, 2.90, 2.81, 2.90, 2.80, 3.00, 2.95, 3.01,
                     2.96, 3.02, 3.14, 3.05, 3.00, 3.16, 3.57, 3.56, 3.59, 3.71,
                     3.60, 3.63, 3.72, 3.73, 3.70, 3.73, 3.69, 3.64, 3.84, 3.75,
                     3.89, 3.90, 3.95, 3.85, 4.01, 3.98, 3.98, 3.98, 3.71, 3.77,
                     3.89, 3.85, 3.85, 3.89, 3.92, 3.94, 3.90, 3.94, 3.86, 3.88,
                     3.85, 3.86, 3.94, 3.89, 3.98, 3.76, 3.92, 3.97, 3.94, 4.00,
                     3.94, 3.88, 3.92, 4.07, 4.08, 4.03, 4.06, 4.06, 4.13, 4.06,
                     3.98, 4.11, 4.06, 4.07, 4.11, 4.09, 4.05, 4.10, 4.23, 4.16,
                     4.14, 4.07, 4.14, 4.19, 4.25, 4.23, 4.11, 4.24, 4.24, 4.29,
                     4.21, 4.31, 4.29, 4.23, 4.28, 4.08, 4.28, 4.27, 4.21, 4.31,
                     4.44, 4.29, 4.28, 4.35, 4.29, 4.40, 4.29, 4.22, 4.37, 4.42,
                     4.42, 4.43, 4.47, 4.53, 4.49, 4.46, 4.53, 4.49, 4.52, 4.49,
                     4.55, 4.62, 4.55, 4.45, 4.61, 4.59, 4.38, 4.56, 4.60, 4.53,
                     4.59, 4.63, 4.59, 4.55, 4.57, 4.57, 4.65, 4.72, 4.63, 4.56,
                     4.72, 4.71, 4.74, 4.83, 4.74, 4.78, 4.75, 4.73, 4.73, 4.79,
                     4.79, 4.75, 4.82, 4.88, 4.53, 4.85, 4.87, 4.88, 4.82, 4.85,
                     4.92, 4.84, 4.91, 4.92, 4.94, 4.97, 4.83, 4.90, 4.93, 4.98,
                     4.99, 4.98, 4.98, 4.98, 5.01, 5.02, 4.98, 5.07, 4.98, 5.06,
                     4.96, 5.05, 5.09, 5.00, 5.09, 5.11, 5.08, 5.02, 4.98, 5.14,
                     5.08, 5.18, 5.23, 5.17, 5.24, 5.21, 5.29, 5.25, 5.16, 5.21,
                     5.03, 5.21, 5.24, 5.27, 5.18, 5.33, 5.24, 5.31, 5.33, 5.23,
                     5.21, 5.29, 5.32, 5.29, 5.41, 5.38, 5.23, 5.35, 5.33, 5.36,
                     5.42, 5.38, 5.34, 5.39, 5.52, 5.49, 5.50, 5.50, 5.46, 5.46,
                     5.39, 5.55, 5.49, 5.58, 5.48, 5.57, 5.51, 5.56, 5.55, 5.60,
                     5.55, 5.55, 5.62, 5.59, 5.59, 5.66, 5.55, 5.67, 5.66, 5.71,
                     5.60, 5.63, 5.69, 5.70, 5.74, 5.82, 5.71, 5.78, 5.77, 5.75,
                     5.77, 5.78, 5.69, 5.87, 5.73, 5.78, 5.84, 5.73, 5.98, 5.89,
                     5.88, 5.92, 5.91, 5.86, 5.83, 5.86, 5.94, 5.99, 5.89, 5.96,
                     5.97, 5.94, 5.96, 5.99, 5.95, 5.95, 6.03, 6.04, 5.99, 6.07,
                     6.04, 6.09, 6.00, 6.08, 6.02, 6.08, 6.07, 6.07, 6.09, 6.18,
                     6.14, 6.18, 6.21, 6.15, 6.17, 6.27, 6.25, 6.25, 6.18, 6.27,
                     6.22, 6.22, 6.16, 6.18, 6.32, 6.22, 6.24, 6.27, 6.33, 6.38,
                     6.26, 6.37, 6.26, 6.27, 6.38, 6.35, 6.38, 6.40, 6.39, 6.31,
                     6.40, 6.31, 6.44, 6.38, 6.46, 6.44, 6.44, 6.43, 6.37, 6.41,
                     6.46, 6.44, 6.50, 6.56, 6.42, 6.56, 6.54, 6.54, 6.63, 6.54,
                     6.50, 6.58, 6.59, 6.63, 6.63, 6.57, 6.59, 6.44, 6.62, 6.65,
                     6.67, 6.67, 6.64, 6.63, 6.68, 6.75, 6.72, 6.65, 6.66, 6.62,
                     6.73, 6.73, 6.77, 6.78, 6.69, 6.70, 6.83, 6.59, 6.69, 6.83,
                     6.79, 6.78, 6.95, 6.93, 6.91, 6.94, 6.90, 6.92, 6.80, 6.90,
                     6.84, 6.96, 6.92, 6.96, 6.92, 6.99, 6.96, 7.11, 6.99, 7.01,
                     6.96, 7.00, 7.32, 7.29, 7.29, 7.26, 7.39, 7.43, 7.36, 7.47,
                     7.53, 7.44, 7.35, 7.43, 7.46, 7.65, 7.51, 7.46, 7.56, 7.44,
                     7.43, 7.58, 7.50, 7.42, 7.50, 7.52, 7.57, 7.56, 7.58, 7.69,
                     7.73, 7.80, 7.72, 7.80, 7.84, 7.90, 7.88, 8.03, 7.99, 8.08,
                     8.12, 8.15, 8.38, 8.45, 8.43, 8.42, 8.39, 8.42, 8.45, 8.44,
                     8.45, 8.55, 8.45, 8.49, 8.54, 8.63, 8.62, 8.57, 8.55, 8.56,
                     8.54, 8.64, 8.66, 8.71, 8.79, 8.73, 8.80, 8.77, 8.82, 8.88,
                     8.96, 8.98, 9.07, 8.98, 9.08, 9.06, 9.09, 9.22, 9.19, 9.20,
                     9.22, 9.37, 9.62, 9.64, 9.57, 9.67, 9.71, 9.71, 9.76, 9.66,
                     9.74, 9.63, 9.85, 9.75, 9.80, 9.85, 9.78, 9.80, 9.78, 9.71,
                     9.69, 9.83, 9.81, 9.92, 9.99, 9.91, 10.02, 10.05, 10.09,
                     10.08, 10.20, 10.17, 10.27, 10.17, 10.30, 10.37, 10.38,
                     10.40, 10.43, 10.42, 10.53, 10.53, 10.77, 10.87, 10.78,
                     10.79, 10.86, 10.78, 10.86, 10.94, 10.87, 11.00, 10.95,
                     10.98, 10.95, 11.04, 11.04, 11.01, 10.97, 10.93, 10.96,
                     10.96, 10.98, 11.10, 11.17, 11.19, 11.21, 11.25, 11.29,
                     11.34, 11.36, 11.51, 11.51, 11.50, 11.57, 11.56, 11.59,
                     11.63, 11.61, 11.62, 11.64, 11.69, 11.82, 12.05, 12.02,
                     12.02, 12.06, 12.03, 12.12, 12.19, 12.24, 12.22, 12.27,
                     12.15, 12.24, 12.30, 12.22, 12.29, 12.15, 12.25, 12.20,
                     12.26, 12.22, 12.28, 12.45, 12.42, 12.43, 12.54, 12.58,
                     12.55, 12.63, 12.73, 12.75, 12.65, 12.82, 12.78, 12.85,
                     12.76, 12.79, 12.90, 12.93, 13.05, 13.09, 13.43, 13.39,
                     13.36, 13.36, 13.44, 13.46, 13.55, 13.38, 13.45, 13.58,
                     13.68, 13.55, 13.65, 13.64, 13.57, 13.57, 13.49, 13.64,
                     13.57, 13.69, 13.63, 13.79, 13.79, 13.78, 13.93, 13.91,
                     13.92, 13.97, 13.94, 14.04, 14.07, 14.17, 14.11, 14.09,
                     14.18, 14.30, 14.19, 14.32, 14.25, 14.38, 14.72, 14.73,
                     14.70, 14.69, 14.72, 14.86, 14.85, 14.85, 14.75, 15.03,
                     14.91, 15.03, 14.98, 14.95, 14.95, 14.91, 14.91]
one_way_delay_p50 = [3.01, 3.08, 3.11, 3.19, 3.12, 3.20, 3.14, 3.27, 3.27, 3.31,
                     3.25, 3.31, 3.42, 3.33, 3.30, 3.45, 3.90, 3.87, 3.90, 4.02,
                     3.94, 3.94, 4.00, 4.05, 4.01, 4.05, 3.96, 3.91, 4.14, 4.08,
                     4.19, 4.21, 4.25, 4.19, 4.32, 4.29, 4.29, 4.28, 4.00, 4.07,
                     4.17, 4.12, 4.16, 4.18, 4.22, 4.21, 4.20, 4.22, 4.17, 4.18,
                     4.13, 4.17, 4.24, 4.19, 4.27, 4.07, 4.21, 4.28, 4.20, 4.33,
                     4.26, 4.20, 4.23, 4.36, 4.36, 4.35, 4.35, 4.34, 4.42, 4.37,
                     4.27, 4.40, 4.37, 4.35, 4.43, 4.39, 4.34, 4.42, 4.49, 4.47,
                     4.46, 4.36, 4.42, 4.51, 4.53, 4.53, 4.45, 4.55, 4.57, 4.59,
                     4.51, 4.61, 4.60, 4.56, 4.60, 4.43, 4.60, 4.59, 4.54, 4.63,
                     4.74, 4.61, 4.58, 4.65, 4.61, 4.70, 4.62, 4.51, 4.67, 4.76,
                     4.73, 4.74, 4.76, 4.79, 4.80, 4.80, 4.83, 4.78, 4.82, 4.79,
                     4.86, 4.91, 4.84, 4.76, 4.90, 4.87, 4.68, 4.87, 4.89, 4.84,
                     4.91, 4.93, 4.89, 4.89, 4.89, 4.89, 4.97, 5.02, 4.96, 4.85,
                     5.03, 5.01, 5.05, 5.13, 5.03, 5.10, 5.08, 5.04, 5.05, 5.10,
                     5.10, 5.08, 5.16, 5.19, 4.81, 5.21, 5.17, 5.21, 5.18, 5.20,
                     5.27, 5.15, 5.25, 5.27, 5.21, 5.30, 5.16, 5.24, 5.27, 5.26,
                     5.29, 5.30, 5.33, 5.33, 5.33, 5.33, 5.34, 5.38, 5.32, 5.38,
                     5.29, 5.36, 5.40, 5.30, 5.43, 5.47, 5.38, 5.32, 5.32, 5.48,
                     5.37, 5.50, 5.55, 5.48, 5.53, 5.53, 5.59, 5.55, 5.49, 5.55,
                     5.31, 5.54, 5.55, 5.58, 5.50, 5.64, 5.55, 5.62, 5.64, 5.53,
                     5.57, 5.63, 5.65, 5.62, 5.73, 5.71, 5.59, 5.64, 5.62, 5.67,
                     5.74, 5.67, 5.65, 5.69, 5.83, 5.81, 5.83, 5.82, 5.76, 5.80,
                     5.73, 5.86, 5.79, 5.92, 5.79, 5.90, 5.82, 5.90, 5.85, 5.90,
                     5.88, 5.87, 5.96, 5.93, 5.90, 5.99, 5.85, 5.97, 5.98, 6.03,
                     5.93, 5.93, 6.02, 6.02, 6.05, 6.12, 6.05, 6.07, 6.07, 6.09,
                     6.08, 6.07, 6.02, 6.16, 6.03, 6.10, 6.16, 6.10, 6.27, 6.21,
                     6.18, 6.25, 6.21, 6.13, 6.17, 6.16, 6.25, 6.30, 6.23, 6.25,
                     6.26, 6.25, 6.28, 6.30, 6.27, 6.28, 6.33, 6.35, 6.32, 6.36,
                     6.33, 6.38, 6.29, 6.39, 6.35, 6.41, 6.37, 6.36, 6.40, 6.51,
                     6.45, 6.50, 6.53, 6.45, 6.48, 6.57, 6.57, 6.55, 6.52, 6.57,
                     6.58, 6.53, 6.49, 6.52, 6.63, 6.54, 6.55, 6.57, 6.63, 6.69,
                     6.56, 6.67, 6.61, 6.59, 6.69, 6.65, 6.69, 6.71, 6.72, 6.61,
                     6.72, 6.64, 6.75, 6.72, 6.79, 6.76, 6.75, 6.74, 6.74, 6.75,
                     6.81, 6.78, 6.81, 6.86, 6.75, 6.88, 6.85, 6.83, 6.94, 6.86,
                     6.78, 6.88, 6.92, 6.91, 6.95, 6.89, 6.95, 6.77, 6.95, 6.98,
                     7.00, 7.00, 6.97, 6.94, 6.99, 7.06, 7.03, 7.00, 6.98, 6.94,
                     7.04, 7.04, 7.06, 7.08, 7.01, 7.02, 7.11, 6.90, 7.04, 7.13,
                     7.12, 7.09, 7.21, 7.26, 7.21, 7.21, 7.20, 7.20, 7.09, 7.18,
                     7.16, 7.25, 7.25, 7.27, 7.23, 7.28, 7.28, 7.43, 7.29, 7.33,
                     7.26, 7.32, 7.75, 7.77, 7.67, 7.69, 7.84, 7.87, 7.85, 7.89,
                     7.96, 7.85, 7.82, 7.89, 7.85, 8.03, 7.95, 7.90, 7.92, 7.81,
                     7.77, 7.90, 7.82, 7.78, 7.83, 7.88, 7.93, 7.90, 7.92, 8.08,
                     8.09, 8.17, 8.15, 8.16, 8.22, 8.25, 8.26, 8.37, 8.37, 8.42,
                     8.42, 8.46, 8.79, 8.85, 8.83, 8.84, 8.85, 8.85, 8.92, 8.90,
                     8.88, 8.97, 8.89, 8.89, 8.94, 9.01, 8.99, 9.00, 8.91, 8.91,
                     8.85, 9.03, 9.08, 9.12, 9.19, 9.15, 9.20, 9.17, 9.16, 9.25,
                     9.33, 9.33, 9.41, 9.35, 9.42, 9.41, 9.46, 9.56, 9.54, 9.56,
                     9.56, 9.67, 10.05, 10.05, 10.02, 10.18, 10.14, 10.13,
                     10.16, 10.08, 10.16, 10.14, 10.29, 10.16, 10.19, 10.25,
                     10.26, 10.27, 10.18, 10.10, 10.05, 10.22, 10.28, 10.33,
                     10.39, 10.30, 10.41, 10.47, 10.46, 10.45, 10.55, 10.54,
                     10.64, 10.55, 10.68, 10.72, 10.77, 10.79, 10.82, 10.79,
                     10.92, 10.94, 11.31, 11.31, 11.31, 11.23, 11.36, 11.37,
                     11.49, 11.42, 11.43, 11.46, 11.45, 11.46, 11.43, 11.50,
                     11.56, 11.55, 11.44, 11.38, 11.43, 11.43, 11.54, 11.60,
                     11.70, 11.70, 11.70, 11.70, 11.80, 11.83, 11.80, 11.95,
                     11.96, 11.96, 12.03, 12.07, 12.08, 12.10, 12.09, 12.15,
                     12.18, 12.21, 12.38, 12.69, 12.66, 12.68, 12.64, 12.68,
                     12.82, 12.81, 12.89, 12.83, 12.89, 12.79, 12.83, 12.90,
                     13.01, 13.08, 12.74, 12.78, 12.96, 12.75, 12.70, 12.83,
                     12.97, 12.95, 13.19, 13.27, 13.31, 13.20, 13.22, 13.32,
                     13.45, 13.29, 13.44, 13.44, 13.54, 13.48, 13.49, 13.60,
                     13.63, 13.72, 13.82, 14.12, 14.09, 14.07, 14.23, 14.15,
                     14.17, 14.38, 14.14, 14.18, 14.31, 14.34, 14.24, 14.34,
                     14.33, 14.32, 14.32, 14.22, 14.33, 14.25, 14.53, 14.46,
                     14.58, 14.59, 14.58, 14.58, 14.56, 14.60, 14.67, 14.66,
                     14.72, 14.79, 14.89, 14.83, 14.83, 14.93, 15.05, 14.94,
                     15.04, 14.98, 15.10, 15.48, 15.47, 15.47, 15.49, 15.52,
                     15.62, 15.64, 15.58, 15.54, 15.77, 15.61, 15.71, 15.65,
                     15.67, 15.71, 15.61, 15.59]

# TODO: 0.9ns/B seems too high for our network as 24Gbps = 3B/ns = 0.33ns/B?
alpha_medium = 3.4
ns_per_byte_medium = 0.9
one_way_delay_model_medium = \
        [alpha_medium + l * ns_per_byte_medium * 1e-3 for l in message_sizes]

alpha_large = 5.6
ns_per_byte_large = 0.31
one_way_delay_model_large = \
        [alpha_large + l * ns_per_byte_large * 1e-3 for l in message_sizes]

plt.xlabel("Message Size (B)")
plt.ylabel("Latency (us)")
plt.scatter(message_sizes, one_way_delay_min, marker='o', s = 10, label="min")
plt.scatter(message_sizes, one_way_delay_p50, marker='o', s = 10, label="p50")
plt.plot(message_sizes, one_way_delay_model_medium, c = 'r', label="model_medium")
plt.plot(message_sizes, one_way_delay_model_large, c = 'r', label="model_large")
plt.legend()
plt.show()

# TODO: compute percentage of per-message overhead and plot; John says 135KB is
# when per-message overhead only accounts for 10% completion time
